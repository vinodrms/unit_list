<loading-component [isLoading]="!didInit"></loading-component>

<div class="row" *ngIf="didInit">
	<div class="row">
		<div *ngIf="canSearch" [ngClass]="{'col-md-4': !isCollapsed, 'col-md-12': isCollapsed}" >
			<div class="input-group">
				<input type="text" class="form-control input-lg" placeholder="{{tableMeta.searchInputPlaceholder}}" [ngFormControl]="textSearchControl" />
				<span class="input-group-btn">
					<button class="btn btn-lg" type="button" (click)="searchByText()">
						<i class="glyphicon glyphicon-search"></i>
					</button>
				</span>
			</div>
		</div>
		<div class="col-md-4" *ngIf="!canSearch && !isCollapsed">
		</div>
		<div class="col-md-4" *ngIf="!isCollapsed">
		</div>
		<div class="col-md-4" *ngIf="!isCollapsed">
			<div>
				<label>{{ 'Show' | translate }}
					<select [ngModel]="numOfItemsPerPage" (change)="didChangeNumOfItemsPerPage($event.target.value)">
						<option value="10">10</option>
						<option value="25">25</option>
						<option value="50">50</option>
						<option value="100">100</option>
					</select> {{ 'items' | translate }}
				</label>
			</div>
		</div>
	</div>
	
	<table class="table table-hover">
		<thead>
			<tr>
				<th></th>
				<th *ngFor="#columnMeta of columnMetaList">
					{{ columnMeta.displayName | translate }}
				</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			<tr *ngFor="#itemVM of itemVMList" [ngClass]="{active: (itemVM.isSelected && canSelect)}">
				<th>
					<input type="checkbox" class="flat" *ngIf="canSelect" [(ngModel)]="itemVM.isSelected" (change)="onItemSelected(itemVM.item, $event.currentTarget.checked)" />
				</th>
				<td *ngFor="#columnMeta of columnMetaList" (click)="canSelect && onItemSelected(itemVM.item, true) && markSelected(itemVM)">
					<span *ngIf="isPercentage(columnMeta.valueMeta)">
						{{ getItemValue(itemVM.item, columnMeta.valueMeta) | percentage }}
					</span>
					<span *ngIf="isPrice(columnMeta.valueMeta)">
						{{ getDependentItemValue(itemVM.item, columnMeta.valueMeta) }}
						{{ getItemValue(itemVM.item, columnMeta.valueMeta) | price }}
					</span>
					<span *ngIf="isStringOrNumber(columnMeta.valueMeta)">
						{{ getItemValue(itemVM.item, columnMeta.valueMeta) }}
					</span>
				</td>
				<td>
					<a class="btn btn-xs" *ngIf="canCopy" (click)="copyItem(itemVM)">
						<i class="fa fa-copy"></i>
					</a>
					<a class="btn btn-xs" *ngIf="canEdit" (click)="editItem(itemVM)">
						<i class="fa fa-edit"></i>
					</a>
					<a class="btn btn-xs" *ngIf="canDelete" (click)="deleteItem(itemVM)">
						<i class="fa fa-remove"></i>
					</a>
				</td>
			</tr>
		</tbody>
	</table>
	<div class="row table-foot">
		<div [ngClass]="{'col-sm-4': !isCollapsed, 'col-md-6': isCollapsed}">
			<a class="btn btn-lg" *ngIf="canAdd" (click)="addItem()">
				<i class="fa fa-plus"></i> {{tableMeta.addButtonText}}
			</a>
		</div>
		<div class="col-sm-4" *ngIf="!isCollapsed">
			<div class="dataTables_info" id="example_info" role="status" aria-live="polite">{{pageNumberStat}}</div>
		</div>
		<div class="text-right"  [ngClass]="{'col-sm-4': !isCollapsed, 'col-md-6': isCollapsed}">
			<ul class="pagination">
				<li [ngClass]="{disabled: isFirstPage()}">
					<a (click)="updatePageNumber(firstPageNumber)">
						<i class="fa fa-angle-double-left"></i>
					</a>
				</li>
				<li *ngFor="#paginationIndex of paginationIndexList" [ngClass]="{active: paginationIndex.isSelected}">
					<a (click)="updatePageNumber(paginationIndex.pageNumber)">{{paginationIndex.displayNumber}}</a>
				</li>
				<li [ngClass]="{disabled: isLastPage()}">
					<a (click)="updatePageNumber(lastPageNumber)">
						<i class="fa fa-angle-double-right"></i>
					</a>
				</li>
			</ul>
		</div>
	</div>
</div>